{
  "application_metadata": {
    "name": "COUSR02C - User Update Program",
    "description": "CICS transaction program for updating user information in the CardDemo application. Allows authorized users to modify existing user records including first name, last name, password, and user type.",
    "domain": "User Security Management"
  },
  "backend": {
    "business_entities": [
      {
        "name": "User",
        "description": "Represents a user in the security system with authentication and profile information",
        "attributes": [
          {
            "name": "user_id",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "Unique identifier for the user"
          },
          {
            "name": "first_name",
            "type": "string",
            "length": 20,
            "required": true,
            "description": "User's first name"
          },
          {
            "name": "last_name",
            "type": "string",
            "length": 20,
            "required": true,
            "description": "User's last name"
          },
          {
            "name": "password",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "User's password for authentication"
          },
          {
            "name": "user_type",
            "type": "string",
            "length": 1,
            "required": true,
            "description": "Type of user that controls permissions"
          }
        ],
        "relationships": []
      }
    ],
    "business_rules": [
      {
        "id": "BR001",
        "name": "User Authentication Prerequisite",
        "description": "User authentication must be performed before accessing the user update functionality",
        "category": "Security",
        "logic": "The program assumes authentication has been completed by the calling program or CICS environment before this program is invoked",
        "conditions": [
          "Program is called with valid communication area"
        ],
        "actions": [
          "Proceed with user update operations"
        ]
      },
      {
        "id": "BR002",
        "name": "User Record Retrieval",
        "description": "User record must be retrieved and locked before any updates can be performed",
        "category": "Data Access",
        "logic": "When a user ID is provided, retrieve the corresponding user record with update lock to prevent concurrent modifications",
        "conditions": [
          "Valid user ID is provided",
          "User record exists in USRSEC file"
        ],
        "actions": [
          "Lock user record for update",
          "Display user information on screen",
          "Allow modifications"
        ]
      },
      {
        "id": "BR003",
        "name": "Modification Detection",
        "description": "Updates are only performed if at least one field has been changed from the original value",
        "category": "Data Integrity",
        "logic": "Compare each input field with the existing data in the user record. Set modification flag if any field differs. Only execute update if modification flag is set.",
        "conditions": [
          "User record has been retrieved",
          "At least one field value differs from original"
        ],
        "actions": [
          "Set user modified flag",
          "Execute update operation",
          "Display success message"
        ]
      },
      {
        "id": "BR004",
        "name": "No Audit Trail",
        "description": "The program does not implement logging or audit trail for user updates",
        "category": "Compliance",
        "logic": "User updates are performed without recording who made the change, when, or what the previous values were",
        "conditions": [
          "User update is successful"
        ],
        "actions": [
          "No audit record is created"
        ]
      },
      {
        "id": "BR005",
        "name": "No Explicit Permission Check",
        "description": "The program does not verify user permissions to perform updates",
        "category": "Security",
        "logic": "Access control is assumed to be handled by the calling program or CICS environment",
        "conditions": [
          "User has accessed the program"
        ],
        "actions": [
          "Allow update operations without additional permission checks"
        ]
      }
    ],
    "validations": [
      {
        "field": "user_id",
        "rule": "Must not be empty or contain only spaces",
        "error_message": "User ID can NOT be empty...",
        "severity": "error"
      },
      {
        "field": "first_name",
        "rule": "Must not be empty or contain only low-values",
        "error_message": "First Name can NOT be empty...",
        "severity": "error"
      },
      {
        "field": "last_name",
        "rule": "Must not be empty or contain only low-values",
        "error_message": "Last Name can NOT be empty...",
        "severity": "error"
      },
      {
        "field": "password",
        "rule": "Must not be empty or contain only low-values",
        "error_message": "Password can NOT be empty...",
        "severity": "error"
      },
      {
        "field": "user_type",
        "rule": "Must not be empty or contain only low-values",
        "error_message": "User Type can NOT be empty...",
        "severity": "error"
      },
      {
        "field": "user_id",
        "rule": "Must exist in USRSEC file",
        "error_message": "User ID NOT found...",
        "severity": "error"
      }
    ],
    "calculations": [],
    "workflows": [
      {
        "name": "User Update Process",
        "description": "Complete workflow for updating user information",
        "steps": [
          {
            "step_number": 1,
            "action": "Receive user ID from previous screen or user input",
            "conditions": [
              "Program is invoked with communication area or user enters ID"
            ],
            "next_step": "2"
          },
          {
            "step_number": 2,
            "action": "Validate user ID is not empty",
            "conditions": [
              "User ID field contains data"
            ],
            "next_step": "3"
          },
          {
            "step_number": 3,
            "action": "Retrieve user record from USRSEC file with update lock",
            "conditions": [
              "User ID is valid"
            ],
            "next_step": "4"
          },
          {
            "step_number": 4,
            "action": "Display user information on screen",
            "conditions": [
              "User record found successfully"
            ],
            "next_step": "5"
          },
          {
            "step_number": 5,
            "action": "User modifies one or more fields",
            "conditions": [
              "User enters new values"
            ],
            "next_step": "6"
          },
          {
            "step_number": 6,
            "action": "Validate all required fields are populated",
            "conditions": [
              "All mandatory fields contain data"
            ],
            "next_step": "7"
          },
          {
            "step_number": 7,
            "action": "Compare modified fields with original values",
            "conditions": [
              "At least one field has changed"
            ],
            "next_step": "8"
          },
          {
            "step_number": 8,
            "action": "Update user record in USRSEC file",
            "conditions": [
              "Modifications detected"
            ],
            "next_step": "9"
          },
          {
            "step_number": 9,
            "action": "Display success message to user",
            "conditions": [
              "Update completed successfully"
            ],
            "next_step": "end"
          }
        ]
      },
      {
        "name": "User Lookup Process",
        "description": "Workflow for retrieving and displaying user information",
        "steps": [
          {
            "step_number": 1,
            "action": "User enters User ID and presses ENTER",
            "conditions": [
              "User ID field is populated"
            ],
            "next_step": "2"
          },
          {
            "step_number": 2,
            "action": "Clear all data fields on screen",
            "conditions": [],
            "next_step": "3"
          },
          {
            "step_number": 3,
            "action": "Retrieve user record from USRSEC file",
            "conditions": [
              "User ID exists in file"
            ],
            "next_step": "4"
          },
          {
            "step_number": 4,
            "action": "Populate screen fields with user data",
            "conditions": [
              "User record retrieved successfully"
            ],
            "next_step": "5"
          },
          {
            "step_number": 5,
            "action": "Display message prompting user to save updates",
            "conditions": [],
            "next_step": "end"
          }
        ]
      }
    ],
    "integrations": [
      {
        "name": "USRSEC File",
        "type": "Data Store",
        "purpose": "Store and retrieve user security information",
        "data_exchanged": [
          "User ID",
          "First Name",
          "Last Name",
          "Password",
          "User Type"
        ],
        "trigger_conditions": [
          "User lookup requested",
          "User update requested"
        ]
      },
      {
        "name": "Communication Area (COMMAREA)",
        "type": "Inter-Program Communication",
        "purpose": "Receive context information from calling program",
        "data_exchanged": [
          "Selected User ID",
          "Program reentry flag",
          "Source program name"
        ],
        "trigger_conditions": [
          "Program invoked from another program"
        ]
      },
      {
        "name": "Admin Menu (COADM01C)",
        "type": "Navigation",
        "purpose": "Return to administrative menu",
        "data_exchanged": [
          "Navigation context"
        ],
        "trigger_conditions": [
          "User presses PF12",
          "User completes update and presses PF3"
        ]
      },
      {
        "name": "Sign-on Program (COSGN00C)",
        "type": "Navigation",
        "purpose": "Return to sign-on screen when no communication area provided",
        "data_exchanged": [],
        "trigger_conditions": [
          "Program invoked without communication area"
        ]
      }
    ],
    "security": {
      "roles": [
        "Administrator",
        "Authorized User"
      ],
      "permissions": [
        {
          "role": "Administrator",
          "resource": "User Records",
          "actions": [
            "view",
            "update"
          ]
        }
      ],
      "authentication_requirements": [
        "User must be authenticated before accessing this program",
        "Authentication is handled by calling program or CICS environment",
        "No explicit permission verification within this program"
      ]
    },
    "error_handling": [
      {
        "error_code": "ERR001",
        "condition": "User ID is empty or contains only spaces",
        "business_impact": "Cannot retrieve or update user information",
        "suggested_action": "Display error message and prompt user to enter valid User ID"
      },
      {
        "error_code": "ERR002",
        "condition": "User ID not found in USRSEC file",
        "business_impact": "Cannot display or update non-existent user",
        "suggested_action": "Display error message indicating user not found"
      },
      {
        "error_code": "ERR003",
        "condition": "First Name is empty",
        "business_impact": "Cannot update user with incomplete information",
        "suggested_action": "Display error message and require First Name entry"
      },
      {
        "error_code": "ERR004",
        "condition": "Last Name is empty",
        "business_impact": "Cannot update user with incomplete information",
        "suggested_action": "Display error message and require Last Name entry"
      },
      {
        "error_code": "ERR005",
        "condition": "Password is empty",
        "business_impact": "Cannot update user without valid password",
        "suggested_action": "Display error message and require Password entry"
      },
      {
        "error_code": "ERR006",
        "condition": "User Type is empty",
        "business_impact": "Cannot update user without valid user type",
        "suggested_action": "Display error message and require User Type entry"
      },
      {
        "error_code": "ERR007",
        "condition": "Unable to read user record from file",
        "business_impact": "Cannot retrieve user information for update",
        "suggested_action": "Display generic error message and log technical details"
      },
      {
        "error_code": "ERR008",
        "condition": "Unable to update user record in file",
        "business_impact": "User modifications are not saved",
        "suggested_action": "Display error message and allow user to retry"
      },
      {
        "error_code": "ERR009",
        "condition": "No modifications detected",
        "business_impact": "Unnecessary update operation attempted",
        "suggested_action": "Display message prompting user to modify data before updating"
      }
    ]
  },
  "frontend": {
    "screens": [
      {
        "id": "COUSR2A",
        "name": "User Update Screen",
        "purpose": "Display and capture user information for update operations",
        "screen_type": "Data Entry and Display",
        "navigation_from": [
          "Admin Menu (COADM01C)",
          "Previous screen with selected user"
        ],
        "navigation_to": [
          "Admin Menu (COADM01C)",
          "Previous screen (CDEMO-FROM-PROGRAM)"
        ],
        "sections": [
          {
            "name": "Header",
            "type": "Display",
            "fields": [
              {
                "name": "title01",
                "label": "Title Line 1",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "Screen title from COTTL01Y",
                "validation": "",
                "help_text": "Primary screen title"
              },
              {
                "name": "title02",
                "label": "Title Line 2",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "Screen subtitle from COTTL01Y",
                "validation": "",
                "help_text": "Secondary screen title"
              },
              {
                "name": "current_date",
                "label": "Current Date",
                "type": "date",
                "input_output": "output",
                "required": false,
                "default_value": "System date in MM/DD/YY format",
                "validation": "",
                "help_text": "Current system date"
              },
              {
                "name": "current_time",
                "label": "Current Time",
                "type": "time",
                "input_output": "output",
                "required": false,
                "default_value": "System time in HH:MM:SS format",
                "validation": "",
                "help_text": "Current system time"
              },
              {
                "name": "transaction_id",
                "label": "Transaction ID",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "CU02",
                "validation": "",
                "help_text": "Current transaction identifier"
              },
              {
                "name": "program_name",
                "label": "Program Name",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "COUSR02C",
                "validation": "",
                "help_text": "Current program name"
              }
            ]
          },
          {
            "name": "User Information",
            "type": "Data Entry",
            "fields": [
              {
                "name": "user_id",
                "label": "User ID",
                "type": "text",
                "input_output": "input",
                "required": true,
                "default_value": "",
                "validation": "Must not be empty; must exist in USRSEC file",
                "help_text": "Enter the User ID to update"
              },
              {
                "name": "first_name",
                "label": "First Name",
                "type": "text",
                "input_output": "both",
                "required": true,
                "default_value": "",
                "validation": "Must not be empty",
                "help_text": "User's first name"
              },
              {
                "name": "last_name",
                "label": "Last Name",
                "type": "text",
                "input_output": "both",
                "required": true,
                "default_value": "",
                "validation": "Must not be empty",
                "help_text": "User's last name"
              },
              {
                "name": "password",
                "label": "Password",
                "type": "password",
                "input_output": "both",
                "required": true,
                "default_value": "",
                "validation": "Must not be empty",
                "help_text": "User's password"
              },
              {
                "name": "user_type",
                "label": "User Type",
                "type": "text",
                "input_output": "both",
                "required": true,
                "default_value": "",
                "validation": "Must not be empty",
                "help_text": "Type of user (controls permissions)"
              }
            ]
          },
          {
            "name": "Messages",
            "type": "Display",
            "fields": [
              {
                "name": "error_message",
                "label": "Message",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "",
                "validation": "",
                "help_text": "Displays error messages, success messages, or instructions"
              }
            ]
          }
        ],
        "actions": [
          {
            "name": "Retrieve User",
            "trigger": "ENTER key",
            "description": "Retrieves and displays user information for the entered User ID",
            "backend_process": "PROCESS-ENTER-KEY",
            "success_navigation": "Stay on current screen with populated data",
            "error_handling": "Display error message if User ID is empty or not found"
          },
          {
            "name": "Update and Return",
            "trigger": "PF3 key",
            "description": "Updates user information and returns to previous screen",
            "backend_process": "UPDATE-USER-INFO",
            "success_navigation": "Return to Admin Menu (COADM01C) or calling program",
            "error_handling": "Display error message and remain on screen if validation fails"
          },
          {
            "name": "Clear Screen",
            "trigger": "PF4 key",
            "description": "Clears all input fields on the current screen",
            "backend_process": "CLEAR-CURRENT-SCREEN",
            "success_navigation": "Stay on current screen with cleared fields",
            "error_handling": "None"
          },
          {
            "name": "Save Updates",
            "trigger": "PF5 key",
            "description": "Updates user information without leaving the screen",
            "backend_process": "UPDATE-USER-INFO",
            "success_navigation": "Stay on current screen with success message",
            "error_handling": "Display error message if validation fails or no modifications detected"
          },
          {
            "name": "Return to Menu",
            "trigger": "PF12 key",
            "description": "Returns to Admin Menu without updating",
            "backend_process": "None",
            "success_navigation": "Return to Admin Menu (COADM01C)",
            "error_handling": "None"
          }
        ],
        "display_rules": [
          {
            "condition": "User ID is entered and ENTER is pressed",
            "affected_fields": [
              "first_name",
              "last_name",
              "password",
              "user_type"
            ],
            "behavior": "Fields are populated with data from USRSEC file"
          },
          {
            "condition": "Error occurs during validation or processing",
            "affected_fields": [
              "error_message"
            ],
            "behavior": "Error message is displayed in red color"
          },
          {
            "condition": "Update is successful",
            "affected_fields": [
              "error_message"
            ],
            "behavior": "Success message is displayed in green color with User ID"
          },
          {
            "condition": "User data is retrieved successfully",
            "affected_fields": [
              "error_message"
            ],
            "behavior": "Instruction message is displayed in neutral color"
          },
          {
            "condition": "No modifications detected on update attempt",
            "affected_fields": [
              "error_message"
            ],
            "behavior": "Warning message is displayed in red color"
          }
        ]
      }
    ],
    "reports": [],
    "navigation_flow": [
      {
        "from_screen": "Admin Menu (COADM01C)",
        "to_screen": "User Update Screen (COUSR2A)",
        "trigger": "User selection with User ID",
        "conditions": [
          "User ID is passed in communication area"
        ]
      },
      {
        "from_screen": "User Update Screen (COUSR2A)",
        "to_screen": "Admin Menu (COADM01C)",
        "trigger": "PF3 key after update or PF12 key",
        "conditions": [
          "User completes update or cancels operation"
        ]
      },
      {
        "from_screen": "User Update Screen (COUSR2A)",
        "to_screen": "Previous Screen (CDEMO-FROM-PROGRAM)",
        "trigger": "PF3 key after update",
        "conditions": [
          "Calling program name is available in communication area"
        ]
      },
      {
        "from_screen": "User Update Screen (COUSR2A)",
        "to_screen": "Sign-on Screen (COSGN00C)",
        "trigger": "Program invoked without communication area",
        "conditions": [
          "EIBCALEN equals zero"
        ]
      }
    ],
    "user_messages": [
      {
        "code": "MSG001",
        "type": "error",
        "message": "User ID can NOT be empty...",
        "context": "User ID field validation"
      },
      {
        "code": "MSG002",
        "type": "error",
        "message": "User ID NOT found...",
        "context": "User lookup in USRSEC file"
      },
      {
        "code": "MSG003",
        "type": "error",
        "message": "First Name can NOT be empty...",
        "context": "First Name field validation"
      },
      {
        "code": "MSG004",
        "type": "error",
        "message": "Last Name can NOT be empty...",
        "context": "Last Name field validation"
      },
      {
        "code": "MSG005",
        "type": "error",
        "message": "Password can NOT be empty...",
        "context": "Password field validation"
      },
      {
        "code": "MSG006",
        "type": "error",
        "message": "User Type can NOT be empty...",
        "context": "User Type field validation"
      },
      {
        "code": "MSG007",
        "type": "error",
        "message": "Unable to lookup User...",
        "context": "Error reading from USRSEC file"
      },
      {
        "code": "MSG008",
        "type": "error",
        "message": "Unable to Update User...",
        "context": "Error updating USRSEC file"
      },
      {
        "code": "MSG009",
        "type": "warning",
        "message": "Please modify to update ...",
        "context": "No modifications detected during update attempt"
      },
      {
        "code": "MSG010",
        "type": "info",
        "message": "Press PF5 key to save your updates ...",
        "context": "User data retrieved successfully"
      },
      {
        "code": "MSG011",
        "type": "success",
        "message": "User [user_id] has been updated ...",
        "context": "User update completed successfully"
      },
      {
        "code": "MSG012",
        "type": "error",
        "message": "Invalid key pressed...",
        "context": "Unsupported function key pressed"
      }
    ]
  },
  "data_flows": [
    {
      "name": "User Selection to Update Screen",
      "description": "Flow of user selection from admin menu to update screen",
      "source": "Admin Menu (COADM01C) or Previous Screen",
      "destination": "User Update Screen (COUSR2A)",
      "data_elements": [
        "Selected User ID",
        "Program reentry flag",
        "Source program name"
      ],
      "transformations": [
        "User ID is moved to screen input field",
        "Automatic user lookup is triggered if User ID is provided"
      ]
    },
    {
      "name": "User Lookup",
      "description": "Retrieval of user information from security file",
      "source": "User Update Screen (COUSR2A)",
      "destination": "USRSEC File",
      "data_elements": [
        "User ID"
      ],
      "transformations": [
        "User ID is used as key to retrieve record",
        "Record is locked for update"
      ]
    },
    {
      "name": "User Data Display",
      "description": "Population of screen fields with retrieved user data",
      "source": "USRSEC File",
      "destination": "User Update Screen (COUSR2A)",
      "data_elements": [
        "First Name",
        "Last Name",
        "Password",
        "User Type"
      ],
      "transformations": [
        "Data is moved from file record to screen output fields"
      ]
    },
    {
      "name": "User Update",
      "description": "Update of user information in security file",
      "source": "User Update Screen (COUSR2A)",
      "destination": "USRSEC File",
      "data_elements": [
        "User ID",
        "First Name",
        "Last Name",
        "Password",
        "User Type"
      ],
      "transformations": [
        "Input fields are validated",
        "Modified fields are compared with original values",
        "Updated record is written back to file if changes detected"
      ]
    },
    {
      "name": "Return Navigation",
      "description": "Return to calling program after update",
      "source": "User Update Screen (COUSR2A)",
      "destination": "Admin Menu (COADM01C) or Previous Screen",
      "data_elements": [
        "Update status",
        "Navigation context"
      ],
      "transformations": [
        "Control is transferred to appropriate program"
      ]
    }
  ],
  "business_constraints": [
    {
      "type": "Data Integrity",
      "description": "All user fields (User ID, First Name, Last Name, Password, User Type) must be populated before update",
      "impact": "Ensures complete user records are maintained in the system"
    },
    {
      "type": "Concurrency Control",
      "description": "User records are locked during retrieval to prevent concurrent modifications",
      "impact": "Prevents data corruption from simultaneous updates"
    },
    {
      "type": "Change Detection",
      "description": "Updates are only executed if at least one field has been modified",
      "impact": "Reduces unnecessary file operations and maintains data consistency"
    },
    {
      "type": "Security",
      "description": "No explicit permission verification is performed within the program",
      "impact": "Relies on external access control mechanisms; potential security gap"
    },
    {
      "type": "Audit and Compliance",
      "description": "No audit trail is maintained for user updates",
      "impact": "Cannot track who made changes, when, or what the previous values were; compliance risk"
    },
    {
      "type": "User Existence",
      "description": "User ID must exist in USRSEC file before update can be performed",
      "impact": "Prevents creation of new users through update function"
    },
    {
      "type": "Password Management",
      "description": "Passwords are stored and displayed in plain text",
      "impact": "Security vulnerability; passwords should be encrypted"
    }
  ]
}