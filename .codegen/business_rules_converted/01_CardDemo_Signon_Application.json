{
  "application_metadata": {
    "name": "CardDemo Signon Application",
    "description": "User authentication and signon screen for the CardDemo application. Validates user credentials against a security file and routes users to appropriate screens based on their user type (admin or regular user).",
    "domain": "Financial Services - Credit Card Management"
  },
  "backend": {
    "business_entities": [
      {
        "name": "User",
        "description": "Represents a user of the CardDemo application with authentication credentials and type classification",
        "attributes": [
          {
            "name": "user_id",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "Unique identifier for the user"
          },
          {
            "name": "password",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "User authentication password"
          },
          {
            "name": "user_type",
            "type": "string",
            "length": 1,
            "required": true,
            "description": "Classification of user (Admin or Regular)"
          }
        ],
        "relationships": [
          {
            "related_entity": "UserSession",
            "relationship_type": "one-to-many",
            "cardinality": "1:N"
          }
        ]
      },
      {
        "name": "UserSession",
        "description": "Represents an active user session with context information",
        "attributes": [
          {
            "name": "user_id",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "User identifier for the session"
          },
          {
            "name": "user_type",
            "type": "string",
            "length": 1,
            "required": true,
            "description": "Type of user in the session"
          },
          {
            "name": "from_transaction_id",
            "type": "string",
            "length": 4,
            "required": true,
            "description": "Transaction ID from which the session originated"
          },
          {
            "name": "from_program",
            "type": "string",
            "length": 8,
            "required": true,
            "description": "Program name from which the session originated"
          },
          {
            "name": "program_context",
            "type": "numeric",
            "length": 4,
            "required": true,
            "description": "Context information for program state"
          }
        ],
        "relationships": [
          {
            "related_entity": "User",
            "relationship_type": "many-to-one",
            "cardinality": "N:1"
          }
        ]
      }
    ],
    "business_rules": [
      {
        "id": "BR001",
        "name": "User Authentication Required",
        "description": "Both User ID and Password must be provided for authentication",
        "category": "Authentication",
        "logic": "User must enter both User ID and Password fields before authentication can proceed",
        "conditions": [
          "User ID field is not empty",
          "Password field is not empty"
        ],
        "actions": [
          "If User ID is empty, display error message and position cursor at User ID field",
          "If Password is empty, display error message and position cursor at Password field",
          "If both fields are populated, proceed with authentication"
        ]
      },
      {
        "id": "BR002",
        "name": "Credential Validation",
        "description": "User credentials must match records in the user security file",
        "category": "Authentication",
        "logic": "User ID must exist in security file and password must match the stored password",
        "conditions": [
          "User ID exists in USRSEC file",
          "Entered password matches stored password for the user"
        ],
        "actions": [
          "If User ID not found, display 'User not found' error and position cursor at User ID field",
          "If password does not match, display 'Wrong Password' error and position cursor at Password field",
          "If credentials are valid, create user session and route to appropriate menu"
        ]
      },
      {
        "id": "BR003",
        "name": "User Type Based Routing",
        "description": "Users are routed to different screens based on their user type after successful authentication",
        "category": "Authorization",
        "logic": "Admin users are directed to admin menu, regular users are directed to main menu",
        "conditions": [
          "User authentication is successful",
          "User type is determined from security file"
        ],
        "actions": [
          "If user type is Admin, transfer control to Admin Menu (COADM01C)",
          "If user type is not Admin, transfer control to Main Menu (COMEN01C)"
        ]
      },
      {
        "id": "BR004",
        "name": "Case Insensitive Credentials",
        "description": "User ID and Password are converted to uppercase for processing",
        "category": "Data Transformation",
        "logic": "All user credentials are normalized to uppercase before validation",
        "conditions": [
          "User enters credentials in any case"
        ],
        "actions": [
          "Convert User ID to uppercase",
          "Convert Password to uppercase",
          "Process credentials in uppercase format"
        ]
      },
      {
        "id": "BR005",
        "name": "Initial Screen Display",
        "description": "When program is first invoked, display empty signon screen with cursor positioned at User ID field",
        "category": "User Interface",
        "logic": "First time entry to the program displays a clean signon screen",
        "conditions": [
          "Program is invoked with no communication area (EIBCALEN = 0)"
        ],
        "actions": [
          "Initialize screen fields to empty values",
          "Position cursor at User ID field",
          "Display signon screen"
        ]
      },
      {
        "id": "BR006",
        "name": "Session Context Initialization",
        "description": "Upon successful authentication, initialize session context with user and program information",
        "category": "Session Management",
        "logic": "Create session context with originating transaction, program, user details, and initial program context",
        "conditions": [
          "User authentication is successful"
        ],
        "actions": [
          "Set session transaction ID to CC00",
          "Set session program name to COSGN00C",
          "Set session user ID to authenticated user ID",
          "Set session user type to user's type from security file",
          "Initialize program context to zeros"
        ]
      },
      {
        "id": "BR007",
        "name": "Exit Application",
        "description": "User can exit the application using PF3 key",
        "category": "Navigation",
        "logic": "Pressing PF3 key displays thank you message and exits the application",
        "conditions": [
          "User presses PF3 key"
        ],
        "actions": [
          "Display thank you message",
          "End transaction"
        ]
      },
      {
        "id": "BR008",
        "name": "Invalid Key Handling",
        "description": "Any key other than Enter or PF3 is considered invalid",
        "category": "User Interface",
        "logic": "Only Enter and PF3 keys are valid on the signon screen",
        "conditions": [
          "User presses a key other than Enter or PF3"
        ],
        "actions": [
          "Display invalid key error message",
          "Redisplay signon screen"
        ]
      }
    ],
    "validations": [
      {
        "field": "user_id",
        "rule": "Required field - cannot be empty or spaces",
        "error_message": "Please enter User ID ...",
        "severity": "error"
      },
      {
        "field": "password",
        "rule": "Required field - cannot be empty or spaces",
        "error_message": "Please enter Password ...",
        "severity": "error"
      },
      {
        "field": "user_id",
        "rule": "Must exist in user security file",
        "error_message": "User not found. Try again ...",
        "severity": "error"
      },
      {
        "field": "password",
        "rule": "Must match password stored in user security file for the given user ID",
        "error_message": "Wrong Password. Try again ...",
        "severity": "error"
      }
    ],
    "calculations": [],
    "workflows": [
      {
        "name": "User Authentication Workflow",
        "description": "Complete workflow for user authentication from initial screen display through successful login or error handling",
        "steps": [
          {
            "step_number": 1,
            "action": "Display initial signon screen with empty fields",
            "conditions": [
              "First time program invocation (EIBCALEN = 0)"
            ],
            "next_step": "2"
          },
          {
            "step_number": 2,
            "action": "Wait for user input",
            "conditions": [
              "Screen is displayed"
            ],
            "next_step": "3"
          },
          {
            "step_number": 3,
            "action": "Evaluate key pressed by user",
            "conditions": [
              "User presses a key"
            ],
            "next_step": "4, 5, or 6"
          },
          {
            "step_number": 4,
            "action": "Process Enter key - validate input fields",
            "conditions": [
              "User presses Enter key"
            ],
            "next_step": "7"
          },
          {
            "step_number": 5,
            "action": "Process PF3 key - exit application",
            "conditions": [
              "User presses PF3 key"
            ],
            "next_step": "End"
          },
          {
            "step_number": 6,
            "action": "Display invalid key error and redisplay screen",
            "conditions": [
              "User presses any other key"
            ],
            "next_step": "2"
          },
          {
            "step_number": 7,
            "action": "Validate User ID field is not empty",
            "conditions": [
              "Enter key was pressed"
            ],
            "next_step": "8 or Error"
          },
          {
            "step_number": 8,
            "action": "Validate Password field is not empty",
            "conditions": [
              "User ID is not empty"
            ],
            "next_step": "9 or Error"
          },
          {
            "step_number": 9,
            "action": "Convert credentials to uppercase",
            "conditions": [
              "Both fields are populated"
            ],
            "next_step": "10"
          },
          {
            "step_number": 10,
            "action": "Read user security file with User ID",
            "conditions": [
              "Credentials are formatted"
            ],
            "next_step": "11, 12, or 13"
          },
          {
            "step_number": 11,
            "action": "Compare entered password with stored password",
            "conditions": [
              "User record found in security file"
            ],
            "next_step": "14 or Error"
          },
          {
            "step_number": 12,
            "action": "Display user not found error",
            "conditions": [
              "User record not found in security file"
            ],
            "next_step": "2"
          },
          {
            "step_number": 13,
            "action": "Display unable to verify user error",
            "conditions": [
              "Other error reading security file"
            ],
            "next_step": "2"
          },
          {
            "step_number": 14,
            "action": "Initialize session context",
            "conditions": [
              "Password matches"
            ],
            "next_step": "15"
          },
          {
            "step_number": 15,
            "action": "Route user based on user type",
            "conditions": [
              "Session context initialized"
            ],
            "next_step": "16 or 17"
          },
          {
            "step_number": 16,
            "action": "Transfer to Admin Menu (COADM01C)",
            "conditions": [
              "User type is Admin"
            ],
            "next_step": "End"
          },
          {
            "step_number": 17,
            "action": "Transfer to Main Menu (COMEN01C)",
            "conditions": [
              "User type is not Admin"
            ],
            "next_step": "End"
          }
        ]
      },
      {
        "name": "Screen Display Workflow",
        "description": "Workflow for preparing and displaying the signon screen with current information",
        "steps": [
          {
            "step_number": 1,
            "action": "Populate header information with titles",
            "conditions": [
              "Screen needs to be displayed"
            ],
            "next_step": "2"
          },
          {
            "step_number": 2,
            "action": "Set transaction and program names",
            "conditions": [
              "Header information being populated"
            ],
            "next_step": "3"
          },
          {
            "step_number": 3,
            "action": "Get and format current date (MM/DD/YY)",
            "conditions": [
              "Header information being populated"
            ],
            "next_step": "4"
          },
          {
            "step_number": 4,
            "action": "Get and format current time (HH:MM:SS)",
            "conditions": [
              "Header information being populated"
            ],
            "next_step": "5"
          },
          {
            "step_number": 5,
            "action": "Retrieve and display application ID",
            "conditions": [
              "Header information being populated"
            ],
            "next_step": "6"
          },
          {
            "step_number": 6,
            "action": "Retrieve and display system ID",
            "conditions": [
              "Header information being populated"
            ],
            "next_step": "7"
          },
          {
            "step_number": 7,
            "action": "Display any error messages",
            "conditions": [
              "Error message exists"
            ],
            "next_step": "8"
          },
          {
            "step_number": 8,
            "action": "Send screen to terminal with cursor positioning",
            "conditions": [
              "All screen data prepared"
            ],
            "next_step": "End"
          }
        ]
      }
    ],
    "integrations": [
      {
        "name": "User Security File Integration",
        "type": "Data File",
        "purpose": "Validate user credentials and retrieve user type information",
        "data_exchanged": [
          "User ID (key)",
          "User Password",
          "User Type"
        ],
        "trigger_conditions": [
          "User submits credentials via Enter key",
          "Both User ID and Password fields are populated"
        ]
      },
      {
        "name": "Admin Menu Integration",
        "type": "Program Transfer",
        "purpose": "Route authenticated admin users to administrative functions",
        "data_exchanged": [
          "Session context (transaction ID, program name, user ID, user type, program context)"
        ],
        "trigger_conditions": [
          "User authentication successful",
          "User type is Admin"
        ]
      },
      {
        "name": "Main Menu Integration",
        "type": "Program Transfer",
        "purpose": "Route authenticated regular users to main application functions",
        "data_exchanged": [
          "Session context (transaction ID, program name, user ID, user type, program context)"
        ],
        "trigger_conditions": [
          "User authentication successful",
          "User type is not Admin"
        ]
      }
    ],
    "security": {
      "roles": [
        "Admin",
        "Regular User"
      ],
      "permissions": [
        {
          "role": "Admin",
          "resource": "Admin Menu",
          "actions": [
            "access"
          ]
        },
        {
          "role": "Regular User",
          "resource": "Main Menu",
          "actions": [
            "access"
          ]
        }
      ],
      "authentication_requirements": [
        "Valid User ID must exist in user security file",
        "Password must match stored password for the user",
        "Credentials are case-insensitive (converted to uppercase)",
        "Both User ID and Password are mandatory fields"
      ]
    },
    "error_handling": [
      {
        "error_code": "ERR001",
        "condition": "User ID field is empty or contains only spaces",
        "business_impact": "User cannot proceed with authentication",
        "suggested_action": "Display error message 'Please enter User ID ...' and position cursor at User ID field"
      },
      {
        "error_code": "ERR002",
        "condition": "Password field is empty or contains only spaces",
        "business_impact": "User cannot proceed with authentication",
        "suggested_action": "Display error message 'Please enter Password ...' and position cursor at Password field"
      },
      {
        "error_code": "ERR003",
        "condition": "User ID not found in user security file",
        "business_impact": "Authentication fails - user cannot access application",
        "suggested_action": "Display error message 'User not found. Try again ...' and position cursor at User ID field"
      },
      {
        "error_code": "ERR004",
        "condition": "Password does not match stored password for user",
        "business_impact": "Authentication fails - user cannot access application",
        "suggested_action": "Display error message 'Wrong Password. Try again ...' and position cursor at Password field"
      },
      {
        "error_code": "ERR005",
        "condition": "Error reading user security file (other than record not found)",
        "business_impact": "Authentication cannot be completed - system error",
        "suggested_action": "Display error message 'Unable to verify the User ...' and position cursor at User ID field"
      },
      {
        "error_code": "ERR006",
        "condition": "Invalid function key pressed (not Enter or PF3)",
        "business_impact": "User action not recognized",
        "suggested_action": "Display invalid key error message and redisplay signon screen"
      }
    ]
  },
  "frontend": {
    "screens": [
      {
        "id": "COSGN0A",
        "name": "Signon Screen",
        "purpose": "Provide user authentication interface for the CardDemo application",
        "screen_type": "Entry/Authentication",
        "navigation_from": [
          "Application Entry Point"
        ],
        "navigation_to": [
          "Admin Menu (COADM01C) - for admin users",
          "Main Menu (COMEN01C) - for regular users",
          "Application Exit - via PF3"
        ],
        "sections": [
          {
            "name": "Header",
            "type": "Display",
            "fields": [
              {
                "name": "title_line_1",
                "label": "Title 1",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "From CCDA-TITLE01",
                "validation": "None",
                "help_text": "First line of application title"
              },
              {
                "name": "title_line_2",
                "label": "Title 2",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "From CCDA-TITLE02",
                "validation": "None",
                "help_text": "Second line of application title"
              },
              {
                "name": "transaction_name",
                "label": "Transaction",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "CC00",
                "validation": "None",
                "help_text": "Current transaction ID"
              },
              {
                "name": "program_name",
                "label": "Program",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "COSGN00C",
                "validation": "None",
                "help_text": "Current program name"
              },
              {
                "name": "current_date",
                "label": "Date",
                "type": "date",
                "input_output": "output",
                "required": true,
                "default_value": "Current system date",
                "validation": "Format: MM/DD/YY",
                "help_text": "Current date in MM/DD/YY format"
              },
              {
                "name": "current_time",
                "label": "Time",
                "type": "time",
                "input_output": "output",
                "required": true,
                "default_value": "Current system time",
                "validation": "Format: HH:MM:SS",
                "help_text": "Current time in HH:MM:SS format"
              },
              {
                "name": "application_id",
                "label": "Application ID",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "System APPLID",
                "validation": "None",
                "help_text": "CICS application identifier"
              },
              {
                "name": "system_id",
                "label": "System ID",
                "type": "text",
                "input_output": "output",
                "required": true,
                "default_value": "System SYSID",
                "validation": "None",
                "help_text": "CICS system identifier"
              }
            ]
          },
          {
            "name": "Authentication",
            "type": "Input",
            "fields": [
              {
                "name": "user_id",
                "label": "User ID",
                "type": "text",
                "input_output": "input",
                "required": true,
                "default_value": "",
                "validation": "Cannot be empty or spaces; converted to uppercase",
                "help_text": "Enter your user ID"
              },
              {
                "name": "password",
                "label": "Password",
                "type": "password",
                "input_output": "input",
                "required": true,
                "default_value": "",
                "validation": "Cannot be empty or spaces; converted to uppercase",
                "help_text": "Enter your password"
              }
            ]
          },
          {
            "name": "Messages",
            "type": "Display",
            "fields": [
              {
                "name": "error_message",
                "label": "Error Message",
                "type": "text",
                "input_output": "output",
                "required": false,
                "default_value": "",
                "validation": "None",
                "help_text": "Displays error or informational messages to the user"
              }
            ]
          }
        ],
        "actions": [
          {
            "name": "Submit Credentials",
            "trigger": "Enter Key",
            "description": "Validate and authenticate user credentials",
            "backend_process": "Process Enter Key workflow - validate fields, read security file, authenticate user",
            "success_navigation": "Admin Menu (COADM01C) for admin users or Main Menu (COMEN01C) for regular users",
            "error_handling": "Display appropriate error message and reposition cursor at relevant field"
          },
          {
            "name": "Exit Application",
            "trigger": "PF3 Key",
            "description": "Exit the CardDemo application",
            "backend_process": "Display thank you message and end transaction",
            "success_navigation": "Application termination",
            "error_handling": "None"
          }
        ],
        "display_rules": [
          {
            "condition": "First time program invocation (EIBCALEN = 0)",
            "affected_fields": [
              "user_id",
              "password",
              "error_message"
            ],
            "behavior": "Initialize all fields to empty values and position cursor at User ID field"
          },
          {
            "condition": "User ID validation fails",
            "affected_fields": [
              "error_message",
              "user_id"
            ],
            "behavior": "Display 'Please enter User ID ...' error message and position cursor at User ID field"
          },
          {
            "condition": "Password validation fails",
            "affected_fields": [
              "error_message",
              "password"
            ],
            "behavior": "Display 'Please enter Password ...' error message and position cursor at Password field"
          },
          {
            "condition": "User not found in security file",
            "affected_fields": [
              "error_message",
              "user_id"
            ],
            "behavior": "Display 'User not found. Try again ...' error message and position cursor at User ID field"
          },
          {
            "condition": "Password does not match",
            "affected_fields": [
              "error_message",
              "password"
            ],
            "behavior": "Display 'Wrong Password. Try again ...' error message and position cursor at Password field"
          },
          {
            "condition": "Invalid key pressed",
            "affected_fields": [
              "error_message"
            ],
            "behavior": "Display invalid key error message and redisplay screen"
          },
          {
            "condition": "Screen display",
            "affected_fields": [
              "current_date",
              "current_time",
              "application_id",
              "system_id"
            ],
            "behavior": "Update with current system values each time screen is displayed"
          }
        ]
      }
    ],
    "reports": [],
    "navigation_flow": [
      {
        "from_screen": "Application Entry",
        "to_screen": "Signon Screen (COSGN0A)",
        "trigger": "Initial program invocation",
        "conditions": [
          "EIBCALEN = 0"
        ]
      },
      {
        "from_screen": "Signon Screen (COSGN0A)",
        "to_screen": "Admin Menu (COADM01C)",
        "trigger": "Successful authentication with Enter key",
        "conditions": [
          "User ID and Password are valid",
          "User type is Admin"
        ]
      },
      {
        "from_screen": "Signon Screen (COSGN0A)",
        "to_screen": "Main Menu (COMEN01C)",
        "trigger": "Successful authentication with Enter key",
        "conditions": [
          "User ID and Password are valid",
          "User type is not Admin"
        ]
      },
      {
        "from_screen": "Signon Screen (COSGN0A)",
        "to_screen": "Application Exit",
        "trigger": "PF3 key pressed",
        "conditions": [
          "User presses PF3"
        ]
      },
      {
        "from_screen": "Signon Screen (COSGN0A)",
        "to_screen": "Signon Screen (COSGN0A)",
        "trigger": "Validation error or invalid key",
        "conditions": [
          "User ID is empty",
          "Password is empty",
          "User not found",
          "Wrong password",
          "Invalid key pressed"
        ]
      }
    ],
    "user_messages": [
      {
        "code": "MSG001",
        "type": "error",
        "message": "Please enter User ID ...",
        "context": "User ID field is empty when Enter is pressed"
      },
      {
        "code": "MSG002",
        "type": "error",
        "message": "Please enter Password ...",
        "context": "Password field is empty when Enter is pressed"
      },
      {
        "code": "MSG003",
        "type": "error",
        "message": "User not found. Try again ...",
        "context": "User ID does not exist in user security file"
      },
      {
        "code": "MSG004",
        "type": "error",
        "message": "Wrong Password. Try again ...",
        "context": "Password does not match stored password for user"
      },
      {
        "code": "MSG005",
        "type": "error",
        "message": "Unable to verify the User ...",
        "context": "System error occurred while reading user security file"
      },
      {
        "code": "MSG006",
        "type": "error",
        "message": "Invalid key pressed",
        "context": "User pressed a key other than Enter or PF3"
      },
      {
        "code": "MSG007",
        "type": "information",
        "message": "Thank you for using CardDemo application",
        "context": "User exits application via PF3 key"
      }
    ]
  },
  "data_flows": [
    {
      "name": "User Credential Input Flow",
      "description": "Flow of user credentials from screen input through validation to authentication",
      "source": "Signon Screen user input fields",
      "destination": "User Security File",
      "data_elements": [
        "User ID",
        "Password"
      ],
      "transformations": [
        "Convert User ID to uppercase",
        "Convert Password to uppercase"
      ]
    },
    {
      "name": "Authentication Result Flow",
      "description": "Flow of authentication results and user information to establish session",
      "source": "User Security File",
      "destination": "Session Context (CARDDEMO-COMMAREA)",
      "data_elements": [
        "User ID",
        "User Type",
        "User Password"
      ],
      "transformations": [
        "Extract user type from security record",
        "Initialize session context with transaction and program information"
      ]
    },
    {
      "name": "Session Context Transfer Flow",
      "description": "Flow of session context to target menu program",
      "source": "Signon Program (COSGN00C)",
      "destination": "Admin Menu (COADM01C) or Main Menu (COMEN01C)",
      "data_elements": [
        "From Transaction ID (CC00)",
        "From Program (COSGN00C)",
        "User ID",
        "User Type",
        "Program Context"
      ],
      "transformations": [
        "Package session information into communication area",
        "Route to appropriate menu based on user type"
      ]
    },
    {
      "name": "Screen Header Information Flow",
      "description": "Flow of system information to screen header display",
      "source": "System (date/time/IDs)",
      "destination": "Signon Screen header fields",
      "data_elements": [
        "Current Date",
        "Current Time",
        "Application ID",
        "System ID",
        "Transaction ID",
        "Program Name"
      ],
      "transformations": [
        "Format date as MM/DD/YY",
        "Format time as HH:MM:SS",
        "Retrieve system identifiers"
      ]
    },
    {
      "name": "Error Message Flow",
      "description": "Flow of error messages to user interface",
      "source": "Validation and authentication logic",
      "destination": "Signon Screen error message field",
      "data_elements": [
        "Error message text",
        "Cursor position indicator"
      ],
      "transformations": [
        "Select appropriate error message based on error condition",
        "Determine cursor position based on error type"
      ]
    }
  ],
  "business_constraints": [
    {
      "type": "Security",
      "description": "All users must authenticate with valid credentials before accessing any application functions",
      "impact": "No access to application features without successful authentication"
    },
    {
      "type": "Authorization",
      "description": "User access to admin functions is restricted based on user type classification",
      "impact": "Only users with Admin type can access administrative menu and functions"
    },
    {
      "type": "Data Integrity",
      "description": "User credentials must exist in the user security file for authentication to succeed",
      "impact": "User security file must be maintained and accessible for application to function"
    },
    {
      "type": "Session Management",
      "description": "Session context must be established and passed between programs to maintain user state",
      "impact": "Communication area must be properly initialized and transferred for application continuity"
    },
    {
      "type": "User Experience",
      "description": "Clear error messages and cursor positioning must guide users to correct input errors",
      "impact": "Users must receive immediate feedback on authentication failures with guidance on correction"
    }
  ]
}